Feat: Implement final intelligent scheduling logic and persistent sessions